{% extends "base/layout.html" %}

{% block title %}Dashboard - AI Game Development Portal{% endblock %}

{% block content %}
<!-- Focused Single Panel Layout -->
<div class="max-w-4xl mx-auto">
    <!-- Main Content Panel -->
    <div class="tech-frame rounded-box aspect-[16/10] mb-8">
        <div class="safe-box">
            <!-- Header -->
            <div class="flex items-center gap-4 mb-6">
                <img src="/static/assets/logos/main-logo.svg" alt="AI Game Dev" class="w-20 h-20 object-contain glow drop-shadow-lg">
                <div>
                    <h1 class="text-4xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent drop-shadow-lg">
                        AI Game Development
                    </h1>
                    <p class="text-xl opacity-90 drop-shadow">Choose your engine to begin creating</p>
                </div>
            </div>
            
            <!-- Engine Selection with Navigation -->
            <div class="flex-1 flex items-center justify-center">
                <div class="flex items-center gap-8">
                    <!-- Back Button -->
                    <button onclick="previousEngine()" class="w-16 h-16 hover:scale-110 transition-transform opacity-60 hover:opacity-100">
                        <img src="/static/assets/buttons/back.png" alt="Previous" class="w-full h-full object-contain">
                    </button>
                    
                    <!-- Current Engine Display -->
                    <div class="engine-showcase">
                        {% for engine in engines %}
                        <a href="/web/new_project?engine={{ engine }}" 
                           class="engine-option {% if loop.first %}active{% endif %}"
                           data-engine="{{ engine }}"
                           style="{% if not loop.first %}display: none;{% endif %}">
                            <img src="/static/assets/engine-panels/{{ engine }}.png" 
                                 alt="{{ engine|title }} Engine" 
                                 class="w-80 h-60 object-cover rounded-xl hover:scale-105 transition-all duration-300 shadow-2xl">
                        </a>
                        {% endfor %}
                    </div>
                    
                    <!-- Next Button -->
                    <button onclick="nextEngine()" class="w-16 h-16 hover:scale-110 transition-transform opacity-60 hover:opacity-100">
                        <img src="/static/assets/buttons/next.png" alt="Next" class="w-full h-full object-contain">
                    </button>
                </div>
            </div>
            
            <!-- Engine Info & Actions -->
            <div class="text-center">
                <div class="engine-info">
                    {% for engine in engines %}
                    <div class="info-panel {% if loop.first %}active{% endif %}" data-engine="{{ engine }}" style="{% if not loop.first %}display: none;{% endif %}">
                        <h2 class="text-2xl font-bold mb-2">{{ engine|title }}</h2>
                        <p class="text-lg opacity-80 mb-4">
                            {% if engine == 'pygame' %}Python 2D Game Development{% elif engine == 'bevy' %}Rust ECS Game Engine{% elif engine == 'godot' %}Visual Scripting Platform{% endif %}
                        </p>
                        <a href="/web/new_project?engine={{ engine }}" class="btn custom-button btn-lg">
                            Start Creating with {{ engine|title }} →
                        </a>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- Quick Stats Row -->
    <div class="grid grid-cols-3 gap-6">
        <div class="glass-panel p-6 rounded-xl text-center">
            <div class="text-3xl font-bold text-primary mb-2">{{ engines|length }}</div>
            <div class="text-sm opacity-70">Game Engines</div>
        </div>
        <div class="glass-panel p-6 rounded-xl text-center">
            <div class="text-3xl font-bold text-secondary mb-2">{{ stats.projects_generated or 0 }}</div>
            <div class="text-sm opacity-70">Projects Created</div>
        </div>
        <div class="glass-panel p-6 rounded-xl text-center">
            <div class="text-3xl font-bold text-accent mb-2">∞</div>
            <div class="text-sm opacity-70">Possibilities</div>
        </div>
    </div>
</div>

<script>
let currentEngine = 0;
const engines = {{ engines|tojson }};

function showEngine(index) {
    // Hide all engine options and info panels
    document.querySelectorAll('.engine-option, .info-panel').forEach(el => {
        el.style.display = 'none';
        el.classList.remove('active');
    });
    
    // Show current engine option and info
    const engineOption = document.querySelector(`[data-engine="${engines[index]}"]`);
    const infoPanel = document.querySelector(`.info-panel[data-engine="${engines[index]}"]`);
    
    if (engineOption) {
        engineOption.style.display = 'block';
        engineOption.classList.add('active');
    }
    if (infoPanel) {
        infoPanel.style.display = 'block';
        infoPanel.classList.add('active');
    }
}

function nextEngine() {
    currentEngine = (currentEngine + 1) % engines.length;
    showEngine(currentEngine);
}

function previousEngine() {
    currentEngine = (currentEngine - 1 + engines.length) % engines.length;
    showEngine(currentEngine);
}
</script>
{% endblock %}