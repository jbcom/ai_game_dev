{% if success %}
<div class="alert alert-success shadow-lg animate-pulse">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
    </svg>
    <div>
        <h3 class="font-bold text-lg">Project Generated Successfully! üéâ</h3>
        <div class="text-sm opacity-90 mt-2 space-y-1">
            <p><strong>Engine:</strong> {{ result.engine_type|title }}</p>
            <p><strong>Main Files:</strong> {{ result.main_files|join(', ') }}</p>
            <p><strong>Generated Files:</strong> {{ result.generated_files_count }} files</p>
            {% if result.project_path != "Generated in memory" %}
            <p><strong>Project Path:</strong> <code class="bg-base-200 px-2 py-1 rounded">{{ result.project_path }}</code></p>
            {% endif %}
        </div>
        
        {% if result.build_instructions %}
        <div class="mt-4">
            <h4 class="font-semibold">Build Instructions:</h4>
            <div class="bg-base-200 p-3 rounded mt-2 text-sm font-mono">
                {% for instruction in result.build_instructions %}
                <div>{{ instruction }}</div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        
        {% if result.asset_requirements %}
        <div class="mt-4">
            <h4 class="font-semibold">Asset Requirements:</h4>
            <div class="flex flex-wrap gap-2 mt-2">
                {% for asset_type, assets in result.asset_requirements.items() %}
                    {% for asset in assets %}
                    <div class="badge badge-outline">{{ asset_type }}: {{ asset }}</div>
                    {% endfor %}
                {% endfor %}
            </div>
        </div>
        {% endif %}
        
        <!-- Variant Detection Alert -->
        {% if result.has_variants %}
        <div class="alert alert-info mt-4">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current flex-shrink-0 w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <div>
                <h4 class="font-bold">üéØ Interactive Choices Detected!</h4>
                <p class="text-sm">We found {{ result.interactive_variants|length }} decisions you can experiment with in your game.</p>
            </div>
            <div class="flex-none">
                <button class="btn btn-sm btn-primary" onclick="startVariantExploration()">
                    üöÄ Explore Choices
                </button>
            </div>
        </div>
        {% endif %}
        
        <div class="flex gap-2 mt-4">
            {% if result.project_id %}
            <button class="btn btn-sm btn-success" onclick="openCodePreview('{{ result.project_id }}')">
                üíª View Code
            </button>
            {% endif %}
            {% if result.has_variants %}
            <button class="btn btn-sm btn-secondary" onclick="showFeatureFlagsPanel(generatedVariants)">
                ‚öôÔ∏è Feature Flags
            </button>
            {% endif %}
            <button class="btn btn-sm btn-primary" onclick="location.reload()">
                Create Another Project
            </button>
            <a href="/web/dashboard" class="btn btn-sm btn-outline">
                Go to Dashboard
            </a>
        </div>
    </div>
</div>
{% else %}
<div class="alert alert-error shadow-lg">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
    </svg>
    <div>
        <h3 class="font-bold text-lg">Generation Failed ‚ùå</h3>
        <div class="text-sm opacity-90 mt-2">
            <p><strong>Error:</strong> {{ error }}</p>
            {% if engine %}
            <p><strong>Engine:</strong> {{ engine|title }}</p>
            {% endif %}
            {% if description %}
            <p><strong>Description:</strong> {{ description|truncate(100) }}</p>
            {% endif %}
        </div>
        
        <div class="mt-4">
            <h4 class="font-semibold">Troubleshooting Tips:</h4>
            <ul class="list-disc list-inside text-sm mt-2 space-y-1">
                <li>Make sure your description is detailed and specific</li>
                <li>Try a different engine or complexity level</li>
                <li>Check that all required fields are filled out</li>
                <li>If the error persists, try again in a few moments</li>
            </ul>
        </div>
        
        <div class="flex gap-2 mt-4">
            <button class="btn btn-sm btn-primary" onclick="document.getElementById('result').innerHTML = ''">
                Try Again
            </button>
            <a href="/web/engines" class="btn btn-sm btn-outline">
                Learn About Engines
            </a>
        </div>
    </div>
</div>
{% endif %}

<!-- Pass variants data to JavaScript -->
{% if success and result.has_variants %}
<script>
// Store the generated variants for the interactive system
window.generatedVariants = {{ result.interactive_variants|tojson }};

function startVariantExploration() {
    if (window.generatedVariants && window.generatedVariants.length > 0) {
        // Start the interactive variant exploration
        showVariantAlert(window.generatedVariants);
    }
}

// Auto-trigger variant exploration after generation (optional)
document.addEventListener('DOMContentLoaded', function() {
    // Uncomment to auto-show variant choices after generation
    // setTimeout(startVariantExploration, 1000);
});
</script>
{% endif %}